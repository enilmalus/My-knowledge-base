#### 1. CVE-2023-34968 
类型：信息泄露漏洞

影响版本：

Samba <4.16.11

4.17.0 ≤ Samba <4.17.10

4.18.0 ≤ Samba <4.18.5

漏洞描述：攻击者可获取服务器端共享路径的敏感信息，泄露真实文件路径。

修复方案：升级至4.16.11/4.17.10/4.18.5或更高版本。

#### 2. CVE-2021-44142 
类型：远程代码执行（高危）

影响版本：

4.13.x <4.13.17

4.14.x <4.14.12

4.15.x <4.15.5

漏洞描述：vfs_fruit模块未验证文件扩展属性长度，攻击者通过写权限在root环境下执行代码。

修复方案：

升级至4.13.17/4.14.12/4.15.5。

临时缓解：从smb.conf中移除fruit模块。

#### 3. CVE-2017-7494 179
类型：远程代码执行（严重）

影响版本：3.5.0至4.6.4/4.5.10/4.4.14之间的版本。

漏洞描述：攻击者通过上传恶意共享库文件（如.so），利用管道名路径符号（如/）触发root权限执行。

修复方案：

升级至安全版本。

临时缓解：在smb.conf中添加nt pipe support = no。

#### 4. CVE-2013-4496 
类型：密码暴力破解漏洞（中危）

影响版本：

Samba 3.x <3.6.23

4.0.x <4.0.16

4.1.x <4.1.6

漏洞描述：未强制密码保护机制，允许通过ChangePasswordUser2 SAMR/RAP实施暴力破解。

修复方案：升级至3.6.23/4.0.16/4.1.6或更高版本。

#### CVE-2007-2447
漏洞位置：当Samba通过MS-RPC提供的未过滤用户输入调用外部脚本时，会直接传递给/bin/sh执行。

触发条件：在smb.conf配置文件中，如果启用了"username map script"选项（通常用于将Windows用户名映射到Unix用户名），攻击者可以通过包含shell元字符（如|、&、;等）的特殊用户名注入恶意命令。

执行上下文：成功利用后，命令将以运行Samba服务的用户权限执行（通常是nobody用户，但在某些配置下可能是root）。

影响范围
受影响版本：Samba 3.0.20至3.0.25rc37

服务端口：通常通过Samba的139/tcp(netbios-ssn)或445/tcp(microsoft-ds)端口利用